package org.bouncycastle2.crypto.engines;

import java.util.Hashtable;
import org.bouncycastle2.crypto.BlockCipher;
import org.bouncycastle2.crypto.CipherParameters;
import org.bouncycastle2.crypto.DataLengthException;
import org.bouncycastle2.crypto.params.KeyParameter;
import org.bouncycastle2.crypto.params.ParametersWithSBox;
import org.bouncycastle2.util.Arrays;
import org.bouncycastle2.util.Strings;

public class GOST28147Engine
  implements BlockCipher
{
  protected static final int BLOCK_SIZE = 8;
  private static byte[] DSbox_A;
  private static byte[] DSbox_Test;
  private static byte[] ESbox_A;
  private static byte[] ESbox_B;
  private static byte[] ESbox_C;
  private static byte[] ESbox_D;
  private static byte[] ESbox_Test;
  private static byte[] Sbox_Default;
  private static Hashtable sBoxes;
  private byte[] S = Sbox_Default;
  private boolean forEncryption;
  private int[] workingKey = null;

  static
  {
    byte[] arrayOfByte1 = new byte[''];
    arrayOfByte1[0] = 4;
    arrayOfByte1[1] = 10;
    arrayOfByte1[2] = 9;
    arrayOfByte1[3] = 2;
    arrayOfByte1[4] = 13;
    arrayOfByte1[5] = 8;
    arrayOfByte1[7] = 14;
    arrayOfByte1[8] = 6;
    arrayOfByte1[9] = 11;
    arrayOfByte1[10] = 1;
    arrayOfByte1[11] = 12;
    arrayOfByte1[12] = 7;
    arrayOfByte1[13] = 15;
    arrayOfByte1[14] = 5;
    arrayOfByte1[15] = 3;
    arrayOfByte1[16] = 14;
    arrayOfByte1[17] = 11;
    arrayOfByte1[18] = 4;
    arrayOfByte1[19] = 12;
    arrayOfByte1[20] = 6;
    arrayOfByte1[21] = 13;
    arrayOfByte1[22] = 15;
    arrayOfByte1[23] = 10;
    arrayOfByte1[24] = 2;
    arrayOfByte1[25] = 3;
    arrayOfByte1[26] = 8;
    arrayOfByte1[27] = 1;
    arrayOfByte1[29] = 7;
    arrayOfByte1[30] = 5;
    arrayOfByte1[31] = 9;
    arrayOfByte1[32] = 5;
    arrayOfByte1[33] = 8;
    arrayOfByte1[34] = 1;
    arrayOfByte1[35] = 13;
    arrayOfByte1[36] = 10;
    arrayOfByte1[37] = 3;
    arrayOfByte1[38] = 4;
    arrayOfByte1[39] = 2;
    arrayOfByte1[40] = 14;
    arrayOfByte1[41] = 15;
    arrayOfByte1[42] = 12;
    arrayOfByte1[43] = 7;
    arrayOfByte1[44] = 6;
    arrayOfByte1[46] = 9;
    arrayOfByte1[47] = 11;
    arrayOfByte1[48] = 7;
    arrayOfByte1[49] = 13;
    arrayOfByte1[50] = 10;
    arrayOfByte1[51] = 1;
    arrayOfByte1[53] = 8;
    arrayOfByte1[54] = 9;
    arrayOfByte1[55] = 15;
    arrayOfByte1[56] = 14;
    arrayOfByte1[57] = 4;
    arrayOfByte1[58] = 6;
    arrayOfByte1[59] = 12;
    arrayOfByte1[60] = 11;
    arrayOfByte1[61] = 2;
    arrayOfByte1[62] = 5;
    arrayOfByte1[63] = 3;
    arrayOfByte1[64] = 6;
    arrayOfByte1[65] = 12;
    arrayOfByte1[66] = 7;
    arrayOfByte1[67] = 1;
    arrayOfByte1[68] = 5;
    arrayOfByte1[69] = 15;
    arrayOfByte1[70] = 13;
    arrayOfByte1[71] = 8;
    arrayOfByte1[72] = 4;
    arrayOfByte1[73] = 10;
    arrayOfByte1[74] = 9;
    arrayOfByte1[75] = 14;
    arrayOfByte1[77] = 3;
    arrayOfByte1[78] = 11;
    arrayOfByte1[79] = 2;
    arrayOfByte1[80] = 4;
    arrayOfByte1[81] = 11;
    arrayOfByte1[82] = 10;
    arrayOfByte1[84] = 7;
    arrayOfByte1[85] = 2;
    arrayOfByte1[86] = 1;
    arrayOfByte1[87] = 13;
    arrayOfByte1[88] = 3;
    arrayOfByte1[89] = 6;
    arrayOfByte1[90] = 8;
    arrayOfByte1[91] = 5;
    arrayOfByte1[92] = 9;
    arrayOfByte1[93] = 12;
    arrayOfByte1[94] = 15;
    arrayOfByte1[95] = 14;
    arrayOfByte1[96] = 13;
    arrayOfByte1[97] = 11;
    arrayOfByte1[98] = 4;
    arrayOfByte1[99] = 1;
    arrayOfByte1[100] = 3;
    arrayOfByte1[101] = 15;
    arrayOfByte1[102] = 5;
    arrayOfByte1[103] = 9;
    arrayOfByte1[105] = 10;
    arrayOfByte1[106] = 14;
    arrayOfByte1[107] = 7;
    arrayOfByte1[108] = 6;
    arrayOfByte1[109] = 8;
    arrayOfByte1[110] = 2;
    arrayOfByte1[111] = 12;
    arrayOfByte1[112] = 1;
    arrayOfByte1[113] = 15;
    arrayOfByte1[114] = 13;
    arrayOfByte1[116] = 5;
    arrayOfByte1[117] = 7;
    arrayOfByte1[118] = 10;
    arrayOfByte1[119] = 4;
    arrayOfByte1[120] = 9;
    arrayOfByte1[121] = 2;
    arrayOfByte1[122] = 3;
    arrayOfByte1[123] = 14;
    arrayOfByte1[124] = 6;
    arrayOfByte1[125] = 11;
    arrayOfByte1[126] = 8;
    arrayOfByte1[127] = 12;
    Sbox_Default = arrayOfByte1;
    byte[] arrayOfByte2 = new byte[''];
    arrayOfByte2[0] = 4;
    arrayOfByte2[1] = 2;
    arrayOfByte2[2] = 15;
    arrayOfByte2[3] = 5;
    arrayOfByte2[4] = 9;
    arrayOfByte2[5] = 1;
    arrayOfByte2[7] = 8;
    arrayOfByte2[8] = 14;
    arrayOfByte2[9] = 3;
    arrayOfByte2[10] = 11;
    arrayOfByte2[11] = 12;
    arrayOfByte2[12] = 13;
    arrayOfByte2[13] = 7;
    arrayOfByte2[14] = 10;
    arrayOfByte2[15] = 6;
    arrayOfByte2[16] = 12;
    arrayOfByte2[17] = 9;
    arrayOfByte2[18] = 15;
    arrayOfByte2[19] = 14;
    arrayOfByte2[20] = 8;
    arrayOfByte2[21] = 1;
    arrayOfByte2[22] = 3;
    arrayOfByte2[23] = 10;
    arrayOfByte2[24] = 2;
    arrayOfByte2[25] = 7;
    arrayOfByte2[26] = 4;
    arrayOfByte2[27] = 13;
    arrayOfByte2[28] = 6;
    arrayOfByte2[30] = 11;
    arrayOfByte2[31] = 5;
    arrayOfByte2[32] = 13;
    arrayOfByte2[33] = 8;
    arrayOfByte2[34] = 14;
    arrayOfByte2[35] = 12;
    arrayOfByte2[36] = 7;
    arrayOfByte2[37] = 3;
    arrayOfByte2[38] = 9;
    arrayOfByte2[39] = 10;
    arrayOfByte2[40] = 1;
    arrayOfByte2[41] = 5;
    arrayOfByte2[42] = 2;
    arrayOfByte2[43] = 4;
    arrayOfByte2[44] = 6;
    arrayOfByte2[45] = 15;
    arrayOfByte2[47] = 11;
    arrayOfByte2[48] = 14;
    arrayOfByte2[49] = 9;
    arrayOfByte2[50] = 11;
    arrayOfByte2[51] = 2;
    arrayOfByte2[52] = 5;
    arrayOfByte2[53] = 15;
    arrayOfByte2[54] = 7;
    arrayOfByte2[55] = 1;
    arrayOfByte2[57] = 13;
    arrayOfByte2[58] = 12;
    arrayOfByte2[59] = 6;
    arrayOfByte2[60] = 10;
    arrayOfByte2[61] = 4;
    arrayOfByte2[62] = 3;
    arrayOfByte2[63] = 8;
    arrayOfByte2[64] = 3;
    arrayOfByte2[65] = 14;
    arrayOfByte2[66] = 5;
    arrayOfByte2[67] = 9;
    arrayOfByte2[68] = 6;
    arrayOfByte2[69] = 8;
    arrayOfByte2[71] = 13;
    arrayOfByte2[72] = 10;
    arrayOfByte2[73] = 11;
    arrayOfByte2[74] = 7;
    arrayOfByte2[75] = 12;
    arrayOfByte2[76] = 2;
    arrayOfByte2[77] = 1;
    arrayOfByte2[78] = 15;
    arrayOfByte2[79] = 4;
    arrayOfByte2[80] = 8;
    arrayOfByte2[81] = 15;
    arrayOfByte2[82] = 6;
    arrayOfByte2[83] = 11;
    arrayOfByte2[84] = 1;
    arrayOfByte2[85] = 9;
    arrayOfByte2[86] = 12;
    arrayOfByte2[87] = 5;
    arrayOfByte2[88] = 13;
    arrayOfByte2[89] = 3;
    arrayOfByte2[90] = 7;
    arrayOfByte2[91] = 10;
    arrayOfByte2[93] = 14;
    arrayOfByte2[94] = 2;
    arrayOfByte2[95] = 4;
    arrayOfByte2[96] = 9;
    arrayOfByte2[97] = 11;
    arrayOfByte2[98] = 12;
    arrayOfByte2[100] = 3;
    arrayOfByte2[101] = 6;
    arrayOfByte2[102] = 7;
    arrayOfByte2[103] = 5;
    arrayOfByte2[104] = 4;
    arrayOfByte2[105] = 8;
    arrayOfByte2[106] = 14;
    arrayOfByte2[107] = 15;
    arrayOfByte2[108] = 1;
    arrayOfByte2[109] = 10;
    arrayOfByte2[110] = 2;
    arrayOfByte2[111] = 13;
    arrayOfByte2[112] = 12;
    arrayOfByte2[113] = 6;
    arrayOfByte2[114] = 5;
    arrayOfByte2[115] = 2;
    arrayOfByte2[116] = 11;
    arrayOfByte2[118] = 9;
    arrayOfByte2[119] = 13;
    arrayOfByte2[120] = 3;
    arrayOfByte2[121] = 14;
    arrayOfByte2[122] = 7;
    arrayOfByte2[123] = 10;
    arrayOfByte2[124] = 15;
    arrayOfByte2[125] = 4;
    arrayOfByte2[126] = 1;
    arrayOfByte2[127] = 8;
    ESbox_Test = arrayOfByte2;
    byte[] arrayOfByte3 = new byte[''];
    arrayOfByte3[0] = 9;
    arrayOfByte3[1] = 6;
    arrayOfByte3[2] = 3;
    arrayOfByte3[3] = 2;
    arrayOfByte3[4] = 8;
    arrayOfByte3[5] = 11;
    arrayOfByte3[6] = 1;
    arrayOfByte3[7] = 7;
    arrayOfByte3[8] = 10;
    arrayOfByte3[9] = 4;
    arrayOfByte3[10] = 14;
    arrayOfByte3[11] = 15;
    arrayOfByte3[12] = 12;
    arrayOfByte3[14] = 13;
    arrayOfByte3[15] = 5;
    arrayOfByte3[16] = 3;
    arrayOfByte3[17] = 7;
    arrayOfByte3[18] = 14;
    arrayOfByte3[19] = 9;
    arrayOfByte3[20] = 8;
    arrayOfByte3[21] = 10;
    arrayOfByte3[22] = 15;
    arrayOfByte3[24] = 5;
    arrayOfByte3[25] = 2;
    arrayOfByte3[26] = 6;
    arrayOfByte3[27] = 12;
    arrayOfByte3[28] = 11;
    arrayOfByte3[29] = 4;
    arrayOfByte3[30] = 13;
    arrayOfByte3[31] = 1;
    arrayOfByte3[32] = 14;
    arrayOfByte3[33] = 4;
    arrayOfByte3[34] = 6;
    arrayOfByte3[35] = 2;
    arrayOfByte3[36] = 11;
    arrayOfByte3[37] = 3;
    arrayOfByte3[38] = 13;
    arrayOfByte3[39] = 8;
    arrayOfByte3[40] = 12;
    arrayOfByte3[41] = 15;
    arrayOfByte3[42] = 5;
    arrayOfByte3[43] = 10;
    arrayOfByte3[45] = 7;
    arrayOfByte3[46] = 1;
    arrayOfByte3[47] = 9;
    arrayOfByte3[48] = 14;
    arrayOfByte3[49] = 7;
    arrayOfByte3[50] = 10;
    arrayOfByte3[51] = 12;
    arrayOfByte3[52] = 13;
    arrayOfByte3[53] = 1;
    arrayOfByte3[54] = 3;
    arrayOfByte3[55] = 9;
    arrayOfByte3[57] = 2;
    arrayOfByte3[58] = 11;
    arrayOfByte3[59] = 4;
    arrayOfByte3[60] = 15;
    arrayOfByte3[61] = 8;
    arrayOfByte3[62] = 5;
    arrayOfByte3[63] = 6;
    arrayOfByte3[64] = 11;
    arrayOfByte3[65] = 5;
    arrayOfByte3[66] = 1;
    arrayOfByte3[67] = 9;
    arrayOfByte3[68] = 8;
    arrayOfByte3[69] = 13;
    arrayOfByte3[70] = 15;
    arrayOfByte3[72] = 14;
    arrayOfByte3[73] = 4;
    arrayOfByte3[74] = 2;
    arrayOfByte3[75] = 3;
    arrayOfByte3[76] = 12;
    arrayOfByte3[77] = 7;
    arrayOfByte3[78] = 10;
    arrayOfByte3[79] = 6;
    arrayOfByte3[80] = 3;
    arrayOfByte3[81] = 10;
    arrayOfByte3[82] = 13;
    arrayOfByte3[83] = 12;
    arrayOfByte3[84] = 1;
    arrayOfByte3[85] = 2;
    arrayOfByte3[87] = 11;
    arrayOfByte3[88] = 7;
    arrayOfByte3[89] = 5;
    arrayOfByte3[90] = 9;
    arrayOfByte3[91] = 4;
    arrayOfByte3[92] = 8;
    arrayOfByte3[93] = 15;
    arrayOfByte3[94] = 14;
    arrayOfByte3[95] = 6;
    arrayOfByte3[96] = 1;
    arrayOfByte3[97] = 13;
    arrayOfByte3[98] = 2;
    arrayOfByte3[99] = 9;
    arrayOfByte3[100] = 7;
    arrayOfByte3[101] = 10;
    arrayOfByte3[102] = 6;
    arrayOfByte3[104] = 8;
    arrayOfByte3[105] = 12;
    arrayOfByte3[106] = 4;
    arrayOfByte3[107] = 5;
    arrayOfByte3[108] = 15;
    arrayOfByte3[109] = 3;
    arrayOfByte3[110] = 11;
    arrayOfByte3[111] = 14;
    arrayOfByte3[112] = 11;
    arrayOfByte3[113] = 10;
    arrayOfByte3[114] = 15;
    arrayOfByte3[115] = 5;
    arrayOfByte3[117] = 12;
    arrayOfByte3[118] = 14;
    arrayOfByte3[119] = 8;
    arrayOfByte3[120] = 6;
    arrayOfByte3[121] = 2;
    arrayOfByte3[122] = 3;
    arrayOfByte3[123] = 9;
    arrayOfByte3[124] = 1;
    arrayOfByte3[125] = 7;
    arrayOfByte3[126] = 13;
    arrayOfByte3[127] = 4;
    ESbox_A = arrayOfByte3;
    byte[] arrayOfByte4 = new byte[''];
    arrayOfByte4[0] = 8;
    arrayOfByte4[1] = 4;
    arrayOfByte4[2] = 11;
    arrayOfByte4[3] = 1;
    arrayOfByte4[4] = 3;
    arrayOfByte4[5] = 5;
    arrayOfByte4[7] = 9;
    arrayOfByte4[8] = 2;
    arrayOfByte4[9] = 14;
    arrayOfByte4[10] = 10;
    arrayOfByte4[11] = 12;
    arrayOfByte4[12] = 13;
    arrayOfByte4[13] = 6;
    arrayOfByte4[14] = 7;
    arrayOfByte4[15] = 15;
    arrayOfByte4[17] = 1;
    arrayOfByte4[18] = 2;
    arrayOfByte4[19] = 10;
    arrayOfByte4[20] = 4;
    arrayOfByte4[21] = 13;
    arrayOfByte4[22] = 5;
    arrayOfByte4[23] = 12;
    arrayOfByte4[24] = 9;
    arrayOfByte4[25] = 7;
    arrayOfByte4[26] = 3;
    arrayOfByte4[27] = 15;
    arrayOfByte4[28] = 11;
    arrayOfByte4[29] = 8;
    arrayOfByte4[30] = 6;
    arrayOfByte4[31] = 14;
    arrayOfByte4[32] = 14;
    arrayOfByte4[33] = 12;
    arrayOfByte4[35] = 10;
    arrayOfByte4[36] = 9;
    arrayOfByte4[37] = 2;
    arrayOfByte4[38] = 13;
    arrayOfByte4[39] = 11;
    arrayOfByte4[40] = 7;
    arrayOfByte4[41] = 5;
    arrayOfByte4[42] = 8;
    arrayOfByte4[43] = 15;
    arrayOfByte4[44] = 3;
    arrayOfByte4[45] = 6;
    arrayOfByte4[46] = 1;
    arrayOfByte4[47] = 4;
    arrayOfByte4[48] = 7;
    arrayOfByte4[49] = 5;
    arrayOfByte4[51] = 13;
    arrayOfByte4[52] = 11;
    arrayOfByte4[53] = 6;
    arrayOfByte4[54] = 1;
    arrayOfByte4[55] = 2;
    arrayOfByte4[56] = 3;
    arrayOfByte4[57] = 10;
    arrayOfByte4[58] = 12;
    arrayOfByte4[59] = 15;
    arrayOfByte4[60] = 4;
    arrayOfByte4[61] = 14;
    arrayOfByte4[62] = 9;
    arrayOfByte4[63] = 8;
    arrayOfByte4[64] = 2;
    arrayOfByte4[65] = 7;
    arrayOfByte4[66] = 12;
    arrayOfByte4[67] = 15;
    arrayOfByte4[68] = 9;
    arrayOfByte4[69] = 5;
    arrayOfByte4[70] = 10;
    arrayOfByte4[71] = 11;
    arrayOfByte4[72] = 1;
    arrayOfByte4[73] = 4;
    arrayOfByte4[75] = 13;
    arrayOfByte4[76] = 6;
    arrayOfByte4[77] = 8;
    arrayOfByte4[78] = 14;
    arrayOfByte4[79] = 3;
    arrayOfByte4[80] = 8;
    arrayOfByte4[81] = 3;
    arrayOfByte4[82] = 2;
    arrayOfByte4[83] = 6;
    arrayOfByte4[84] = 4;
    arrayOfByte4[85] = 13;
    arrayOfByte4[86] = 14;
    arrayOfByte4[87] = 11;
    arrayOfByte4[88] = 12;
    arrayOfByte4[89] = 1;
    arrayOfByte4[90] = 7;
    arrayOfByte4[91] = 15;
    arrayOfByte4[92] = 10;
    arrayOfByte4[94] = 9;
    arrayOfByte4[95] = 5;
    arrayOfByte4[96] = 5;
    arrayOfByte4[97] = 2;
    arrayOfByte4[98] = 10;
    arrayOfByte4[99] = 11;
    arrayOfByte4[100] = 9;
    arrayOfByte4[101] = 1;
    arrayOfByte4[102] = 12;
    arrayOfByte4[103] = 3;
    arrayOfByte4[104] = 7;
    arrayOfByte4[105] = 4;
    arrayOfByte4[106] = 13;
    arrayOfByte4[108] = 6;
    arrayOfByte4[109] = 15;
    arrayOfByte4[110] = 8;
    arrayOfByte4[111] = 14;
    arrayOfByte4[113] = 4;
    arrayOfByte4[114] = 11;
    arrayOfByte4[115] = 14;
    arrayOfByte4[116] = 8;
    arrayOfByte4[117] = 3;
    arrayOfByte4[118] = 7;
    arrayOfByte4[119] = 1;
    arrayOfByte4[120] = 10;
    arrayOfByte4[121] = 2;
    arrayOfByte4[122] = 9;
    arrayOfByte4[123] = 6;
    arrayOfByte4[124] = 15;
    arrayOfByte4[125] = 13;
    arrayOfByte4[126] = 5;
    arrayOfByte4[127] = 12;
    ESbox_B = arrayOfByte4;
    byte[] arrayOfByte5 = new byte[''];
    arrayOfByte5[0] = 1;
    arrayOfByte5[1] = 11;
    arrayOfByte5[2] = 12;
    arrayOfByte5[3] = 2;
    arrayOfByte5[4] = 9;
    arrayOfByte5[5] = 13;
    arrayOfByte5[7] = 15;
    arrayOfByte5[8] = 4;
    arrayOfByte5[9] = 5;
    arrayOfByte5[10] = 8;
    arrayOfByte5[11] = 14;
    arrayOfByte5[12] = 10;
    arrayOfByte5[13] = 7;
    arrayOfByte5[14] = 6;
    arrayOfByte5[15] = 3;
    arrayOfByte5[17] = 1;
    arrayOfByte5[18] = 7;
    arrayOfByte5[19] = 13;
    arrayOfByte5[20] = 11;
    arrayOfByte5[21] = 4;
    arrayOfByte5[22] = 5;
    arrayOfByte5[23] = 2;
    arrayOfByte5[24] = 8;
    arrayOfByte5[25] = 14;
    arrayOfByte5[26] = 15;
    arrayOfByte5[27] = 12;
    arrayOfByte5[28] = 9;
    arrayOfByte5[29] = 10;
    arrayOfByte5[30] = 6;
    arrayOfByte5[31] = 3;
    arrayOfByte5[32] = 8;
    arrayOfByte5[33] = 2;
    arrayOfByte5[34] = 5;
    arrayOfByte5[36] = 4;
    arrayOfByte5[37] = 9;
    arrayOfByte5[38] = 15;
    arrayOfByte5[39] = 10;
    arrayOfByte5[40] = 3;
    arrayOfByte5[41] = 7;
    arrayOfByte5[42] = 12;
    arrayOfByte5[43] = 13;
    arrayOfByte5[44] = 6;
    arrayOfByte5[45] = 14;
    arrayOfByte5[46] = 1;
    arrayOfByte5[47] = 11;
    arrayOfByte5[48] = 3;
    arrayOfByte5[49] = 6;
    arrayOfByte5[51] = 1;
    arrayOfByte5[52] = 5;
    arrayOfByte5[53] = 13;
    arrayOfByte5[54] = 10;
    arrayOfByte5[55] = 8;
    arrayOfByte5[56] = 11;
    arrayOfByte5[57] = 2;
    arrayOfByte5[58] = 9;
    arrayOfByte5[59] = 7;
    arrayOfByte5[60] = 14;
    arrayOfByte5[61] = 15;
    arrayOfByte5[62] = 12;
    arrayOfByte5[63] = 4;
    arrayOfByte5[64] = 8;
    arrayOfByte5[65] = 13;
    arrayOfByte5[66] = 11;
    arrayOfByte5[68] = 4;
    arrayOfByte5[69] = 5;
    arrayOfByte5[70] = 1;
    arrayOfByte5[71] = 2;
    arrayOfByte5[72] = 9;
    arrayOfByte5[73] = 3;
    arrayOfByte5[74] = 12;
    arrayOfByte5[75] = 14;
    arrayOfByte5[76] = 6;
    arrayOfByte5[77] = 15;
    arrayOfByte5[78] = 10;
    arrayOfByte5[79] = 7;
    arrayOfByte5[80] = 12;
    arrayOfByte5[81] = 9;
    arrayOfByte5[82] = 11;
    arrayOfByte5[83] = 1;
    arrayOfByte5[84] = 8;
    arrayOfByte5[85] = 14;
    arrayOfByte5[86] = 2;
    arrayOfByte5[87] = 4;
    arrayOfByte5[88] = 7;
    arrayOfByte5[89] = 3;
    arrayOfByte5[90] = 6;
    arrayOfByte5[91] = 5;
    arrayOfByte5[92] = 10;
    arrayOfByte5[94] = 15;
    arrayOfByte5[95] = 13;
    arrayOfByte5[96] = 10;
    arrayOfByte5[97] = 9;
    arrayOfByte5[98] = 6;
    arrayOfByte5[99] = 8;
    arrayOfByte5[100] = 13;
    arrayOfByte5[101] = 14;
    arrayOfByte5[102] = 2;
    arrayOfByte5[104] = 15;
    arrayOfByte5[105] = 3;
    arrayOfByte5[106] = 5;
    arrayOfByte5[107] = 11;
    arrayOfByte5[108] = 4;
    arrayOfByte5[109] = 1;
    arrayOfByte5[110] = 12;
    arrayOfByte5[111] = 7;
    arrayOfByte5[112] = 7;
    arrayOfByte5[113] = 4;
    arrayOfByte5[115] = 5;
    arrayOfByte5[116] = 10;
    arrayOfByte5[117] = 2;
    arrayOfByte5[118] = 15;
    arrayOfByte5[119] = 14;
    arrayOfByte5[120] = 12;
    arrayOfByte5[121] = 6;
    arrayOfByte5[122] = 1;
    arrayOfByte5[123] = 11;
    arrayOfByte5[124] = 13;
    arrayOfByte5[125] = 9;
    arrayOfByte5[126] = 3;
    arrayOfByte5[127] = 8;
    ESbox_C = arrayOfByte5;
    byte[] arrayOfByte6 = new byte[''];
    arrayOfByte6[0] = 15;
    arrayOfByte6[1] = 12;
    arrayOfByte6[2] = 2;
    arrayOfByte6[3] = 10;
    arrayOfByte6[4] = 6;
    arrayOfByte6[5] = 4;
    arrayOfByte6[6] = 5;
    arrayOfByte6[8] = 7;
    arrayOfByte6[9] = 9;
    arrayOfByte6[10] = 14;
    arrayOfByte6[11] = 13;
    arrayOfByte6[12] = 1;
    arrayOfByte6[13] = 11;
    arrayOfByte6[14] = 8;
    arrayOfByte6[15] = 3;
    arrayOfByte6[16] = 11;
    arrayOfByte6[17] = 6;
    arrayOfByte6[18] = 3;
    arrayOfByte6[19] = 4;
    arrayOfByte6[20] = 12;
    arrayOfByte6[21] = 15;
    arrayOfByte6[22] = 14;
    arrayOfByte6[23] = 2;
    arrayOfByte6[24] = 7;
    arrayOfByte6[25] = 13;
    arrayOfByte6[26] = 8;
    arrayOfByte6[28] = 5;
    arrayOfByte6[29] = 10;
    arrayOfByte6[30] = 9;
    arrayOfByte6[31] = 1;
    arrayOfByte6[32] = 1;
    arrayOfByte6[33] = 12;
    arrayOfByte6[34] = 11;
    arrayOfByte6[36] = 15;
    arrayOfByte6[37] = 14;
    arrayOfByte6[38] = 6;
    arrayOfByte6[39] = 5;
    arrayOfByte6[40] = 10;
    arrayOfByte6[41] = 13;
    arrayOfByte6[42] = 4;
    arrayOfByte6[43] = 8;
    arrayOfByte6[44] = 9;
    arrayOfByte6[45] = 3;
    arrayOfByte6[46] = 7;
    arrayOfByte6[47] = 2;
    arrayOfByte6[48] = 1;
    arrayOfByte6[49] = 5;
    arrayOfByte6[50] = 14;
    arrayOfByte6[51] = 12;
    arrayOfByte6[52] = 10;
    arrayOfByte6[53] = 7;
    arrayOfByte6[55] = 13;
    arrayOfByte6[56] = 6;
    arrayOfByte6[57] = 2;
    arrayOfByte6[58] = 11;
    arrayOfByte6[59] = 4;
    arrayOfByte6[60] = 9;
    arrayOfByte6[61] = 3;
    arrayOfByte6[62] = 15;
    arrayOfByte6[63] = 8;
    arrayOfByte6[65] = 12;
    arrayOfByte6[66] = 8;
    arrayOfByte6[67] = 9;
    arrayOfByte6[68] = 13;
    arrayOfByte6[69] = 2;
    arrayOfByte6[70] = 10;
    arrayOfByte6[71] = 11;
    arrayOfByte6[72] = 7;
    arrayOfByte6[73] = 3;
    arrayOfByte6[74] = 6;
    arrayOfByte6[75] = 5;
    arrayOfByte6[76] = 4;
    arrayOfByte6[77] = 14;
    arrayOfByte6[78] = 15;
    arrayOfByte6[79] = 1;
    arrayOfByte6[80] = 8;
    arrayOfByte6[82] = 15;
    arrayOfByte6[83] = 3;
    arrayOfByte6[84] = 2;
    arrayOfByte6[85] = 5;
    arrayOfByte6[86] = 14;
    arrayOfByte6[87] = 11;
    arrayOfByte6[88] = 1;
    arrayOfByte6[89] = 10;
    arrayOfByte6[90] = 4;
    arrayOfByte6[91] = 7;
    arrayOfByte6[92] = 12;
    arrayOfByte6[93] = 9;
    arrayOfByte6[94] = 13;
    arrayOfByte6[95] = 6;
    arrayOfByte6[96] = 3;
    arrayOfByte6[98] = 6;
    arrayOfByte6[99] = 15;
    arrayOfByte6[100] = 1;
    arrayOfByte6[101] = 14;
    arrayOfByte6[102] = 9;
    arrayOfByte6[103] = 2;
    arrayOfByte6[104] = 13;
    arrayOfByte6[105] = 8;
    arrayOfByte6[106] = 12;
    arrayOfByte6[107] = 4;
    arrayOfByte6[108] = 11;
    arrayOfByte6[109] = 10;
    arrayOfByte6[110] = 5;
    arrayOfByte6[111] = 7;
    arrayOfByte6[112] = 1;
    arrayOfByte6[113] = 10;
    arrayOfByte6[114] = 6;
    arrayOfByte6[115] = 8;
    arrayOfByte6[116] = 15;
    arrayOfByte6[117] = 11;
    arrayOfByte6[119] = 4;
    arrayOfByte6[120] = 12;
    arrayOfByte6[121] = 3;
    arrayOfByte6[122] = 5;
    arrayOfByte6[123] = 9;
    arrayOfByte6[124] = 7;
    arrayOfByte6[125] = 13;
    arrayOfByte6[126] = 2;
    arrayOfByte6[127] = 14;
    ESbox_D = arrayOfByte6;
    byte[] arrayOfByte7 = new byte[''];
    arrayOfByte7[0] = 4;
    arrayOfByte7[1] = 10;
    arrayOfByte7[2] = 9;
    arrayOfByte7[3] = 2;
    arrayOfByte7[4] = 13;
    arrayOfByte7[5] = 8;
    arrayOfByte7[7] = 14;
    arrayOfByte7[8] = 6;
    arrayOfByte7[9] = 11;
    arrayOfByte7[10] = 1;
    arrayOfByte7[11] = 12;
    arrayOfByte7[12] = 7;
    arrayOfByte7[13] = 15;
    arrayOfByte7[14] = 5;
    arrayOfByte7[15] = 3;
    arrayOfByte7[16] = 14;
    arrayOfByte7[17] = 11;
    arrayOfByte7[18] = 4;
    arrayOfByte7[19] = 12;
    arrayOfByte7[20] = 6;
    arrayOfByte7[21] = 13;
    arrayOfByte7[22] = 15;
    arrayOfByte7[23] = 10;
    arrayOfByte7[24] = 2;
    arrayOfByte7[25] = 3;
    arrayOfByte7[26] = 8;
    arrayOfByte7[27] = 1;
    arrayOfByte7[29] = 7;
    arrayOfByte7[30] = 5;
    arrayOfByte7[31] = 9;
    arrayOfByte7[32] = 5;
    arrayOfByte7[33] = 8;
    arrayOfByte7[34] = 1;
    arrayOfByte7[35] = 13;
    arrayOfByte7[36] = 10;
    arrayOfByte7[37] = 3;
    arrayOfByte7[38] = 4;
    arrayOfByte7[39] = 2;
    arrayOfByte7[40] = 14;
    arrayOfByte7[41] = 15;
    arrayOfByte7[42] = 12;
    arrayOfByte7[43] = 7;
    arrayOfByte7[44] = 6;
    arrayOfByte7[46] = 9;
    arrayOfByte7[47] = 11;
    arrayOfByte7[48] = 7;
    arrayOfByte7[49] = 13;
    arrayOfByte7[50] = 10;
    arrayOfByte7[51] = 1;
    arrayOfByte7[53] = 8;
    arrayOfByte7[54] = 9;
    arrayOfByte7[55] = 15;
    arrayOfByte7[56] = 14;
    arrayOfByte7[57] = 4;
    arrayOfByte7[58] = 6;
    arrayOfByte7[59] = 12;
    arrayOfByte7[60] = 11;
    arrayOfByte7[61] = 2;
    arrayOfByte7[62] = 5;
    arrayOfByte7[63] = 3;
    arrayOfByte7[64] = 6;
    arrayOfByte7[65] = 12;
    arrayOfByte7[66] = 7;
    arrayOfByte7[67] = 1;
    arrayOfByte7[68] = 5;
    arrayOfByte7[69] = 15;
    arrayOfByte7[70] = 13;
    arrayOfByte7[71] = 8;
    arrayOfByte7[72] = 4;
    arrayOfByte7[73] = 10;
    arrayOfByte7[74] = 9;
    arrayOfByte7[75] = 14;
    arrayOfByte7[77] = 3;
    arrayOfByte7[78] = 11;
    arrayOfByte7[79] = 2;
    arrayOfByte7[80] = 4;
    arrayOfByte7[81] = 11;
    arrayOfByte7[82] = 10;
    arrayOfByte7[84] = 7;
    arrayOfByte7[85] = 2;
    arrayOfByte7[86] = 1;
    arrayOfByte7[87] = 13;
    arrayOfByte7[88] = 3;
    arrayOfByte7[89] = 6;
    arrayOfByte7[90] = 8;
    arrayOfByte7[91] = 5;
    arrayOfByte7[92] = 9;
    arrayOfByte7[93] = 12;
    arrayOfByte7[94] = 15;
    arrayOfByte7[95] = 14;
    arrayOfByte7[96] = 13;
    arrayOfByte7[97] = 11;
    arrayOfByte7[98] = 4;
    arrayOfByte7[99] = 1;
    arrayOfByte7[100] = 3;
    arrayOfByte7[101] = 15;
    arrayOfByte7[102] = 5;
    arrayOfByte7[103] = 9;
    arrayOfByte7[105] = 10;
    arrayOfByte7[106] = 14;
    arrayOfByte7[107] = 7;
    arrayOfByte7[108] = 6;
    arrayOfByte7[109] = 8;
    arrayOfByte7[110] = 2;
    arrayOfByte7[111] = 12;
    arrayOfByte7[112] = 1;
    arrayOfByte7[113] = 15;
    arrayOfByte7[114] = 13;
    arrayOfByte7[116] = 5;
    arrayOfByte7[117] = 7;
    arrayOfByte7[118] = 10;
    arrayOfByte7[119] = 4;
    arrayOfByte7[120] = 9;
    arrayOfByte7[121] = 2;
    arrayOfByte7[122] = 3;
    arrayOfByte7[123] = 14;
    arrayOfByte7[124] = 6;
    arrayOfByte7[125] = 11;
    arrayOfByte7[126] = 8;
    arrayOfByte7[127] = 12;
    DSbox_Test = arrayOfByte7;
    byte[] arrayOfByte8 = new byte[''];
    arrayOfByte8[0] = 10;
    arrayOfByte8[1] = 4;
    arrayOfByte8[2] = 5;
    arrayOfByte8[3] = 6;
    arrayOfByte8[4] = 8;
    arrayOfByte8[5] = 1;
    arrayOfByte8[6] = 3;
    arrayOfByte8[7] = 7;
    arrayOfByte8[8] = 13;
    arrayOfByte8[9] = 12;
    arrayOfByte8[10] = 14;
    arrayOfByte8[12] = 9;
    arrayOfByte8[13] = 2;
    arrayOfByte8[14] = 11;
    arrayOfByte8[15] = 15;
    arrayOfByte8[16] = 5;
    arrayOfByte8[17] = 15;
    arrayOfByte8[18] = 4;
    arrayOfByte8[20] = 2;
    arrayOfByte8[21] = 13;
    arrayOfByte8[22] = 11;
    arrayOfByte8[23] = 9;
    arrayOfByte8[24] = 1;
    arrayOfByte8[25] = 7;
    arrayOfByte8[26] = 6;
    arrayOfByte8[27] = 3;
    arrayOfByte8[28] = 12;
    arrayOfByte8[29] = 14;
    arrayOfByte8[30] = 10;
    arrayOfByte8[31] = 8;
    arrayOfByte8[32] = 7;
    arrayOfByte8[33] = 15;
    arrayOfByte8[34] = 12;
    arrayOfByte8[35] = 14;
    arrayOfByte8[36] = 9;
    arrayOfByte8[37] = 4;
    arrayOfByte8[38] = 1;
    arrayOfByte8[40] = 3;
    arrayOfByte8[41] = 11;
    arrayOfByte8[42] = 5;
    arrayOfByte8[43] = 2;
    arrayOfByte8[44] = 6;
    arrayOfByte8[45] = 10;
    arrayOfByte8[46] = 8;
    arrayOfByte8[47] = 13;
    arrayOfByte8[48] = 4;
    arrayOfByte8[49] = 10;
    arrayOfByte8[50] = 7;
    arrayOfByte8[51] = 12;
    arrayOfByte8[53] = 15;
    arrayOfByte8[54] = 2;
    arrayOfByte8[55] = 8;
    arrayOfByte8[56] = 14;
    arrayOfByte8[57] = 1;
    arrayOfByte8[58] = 6;
    arrayOfByte8[59] = 5;
    arrayOfByte8[60] = 13;
    arrayOfByte8[61] = 11;
    arrayOfByte8[62] = 9;
    arrayOfByte8[63] = 3;
    arrayOfByte8[64] = 7;
    arrayOfByte8[65] = 6;
    arrayOfByte8[66] = 4;
    arrayOfByte8[67] = 11;
    arrayOfByte8[68] = 9;
    arrayOfByte8[69] = 12;
    arrayOfByte8[70] = 2;
    arrayOfByte8[71] = 10;
    arrayOfByte8[72] = 1;
    arrayOfByte8[73] = 8;
    arrayOfByte8[75] = 14;
    arrayOfByte8[76] = 15;
    arrayOfByte8[77] = 13;
    arrayOfByte8[78] = 3;
    arrayOfByte8[79] = 5;
    arrayOfByte8[80] = 7;
    arrayOfByte8[81] = 6;
    arrayOfByte8[82] = 2;
    arrayOfByte8[83] = 4;
    arrayOfByte8[84] = 13;
    arrayOfByte8[85] = 9;
    arrayOfByte8[86] = 15;
    arrayOfByte8[88] = 10;
    arrayOfByte8[89] = 1;
    arrayOfByte8[90] = 5;
    arrayOfByte8[91] = 11;
    arrayOfByte8[92] = 8;
    arrayOfByte8[93] = 14;
    arrayOfByte8[94] = 12;
    arrayOfByte8[95] = 3;
    arrayOfByte8[96] = 13;
    arrayOfByte8[97] = 14;
    arrayOfByte8[98] = 4;
    arrayOfByte8[99] = 1;
    arrayOfByte8[100] = 7;
    arrayOfByte8[102] = 5;
    arrayOfByte8[103] = 10;
    arrayOfByte8[104] = 3;
    arrayOfByte8[105] = 12;
    arrayOfByte8[106] = 8;
    arrayOfByte8[107] = 15;
    arrayOfByte8[108] = 6;
    arrayOfByte8[109] = 2;
    arrayOfByte8[110] = 9;
    arrayOfByte8[111] = 11;
    arrayOfByte8[112] = 1;
    arrayOfByte8[113] = 3;
    arrayOfByte8[114] = 10;
    arrayOfByte8[115] = 9;
    arrayOfByte8[116] = 5;
    arrayOfByte8[117] = 11;
    arrayOfByte8[118] = 4;
    arrayOfByte8[119] = 15;
    arrayOfByte8[120] = 8;
    arrayOfByte8[121] = 6;
    arrayOfByte8[122] = 7;
    arrayOfByte8[123] = 14;
    arrayOfByte8[124] = 13;
    arrayOfByte8[126] = 2;
    arrayOfByte8[127] = 12;
    DSbox_A = arrayOfByte8;
    sBoxes = new Hashtable();
    addSBox("Default", Sbox_Default);
    addSBox("E-TEST", ESbox_Test);
    addSBox("E-A", ESbox_A);
    addSBox("E-B", ESbox_B);
    addSBox("E-C", ESbox_C);
    addSBox("E-D", ESbox_D);
    addSBox("D-TEST", DSbox_Test);
    addSBox("D-A", DSbox_A);
  }

  private void GOST28147Func(int[] paramArrayOfInt, byte[] paramArrayOfByte1, int paramInt1, byte[] paramArrayOfByte2, int paramInt2)
  {
    int i = bytesToint(paramArrayOfByte1, paramInt1);
    int j = bytesToint(paramArrayOfByte1, paramInt1 + 4);
    if (this.forEncryption)
    {
      int i4 = 0;
      if (i4 >= 3);
      for (int i7 = 7; ; i7--)
      {
        if (i7 <= 0)
        {
          int i3 = j ^ GOST28147_mainStep(i, paramArrayOfInt[0]);
          intTobytes(i, paramArrayOfByte2, paramInt2);
          intTobytes(i3, paramArrayOfByte2, paramInt2 + 4);
          return;
          for (int i5 = 0; ; i5++)
          {
            if (i5 >= 8)
            {
              i4++;
              break;
            }
            int i6 = i;
            i = j ^ GOST28147_mainStep(i, paramArrayOfInt[i5]);
            j = i6;
          }
        }
        int i8 = i;
        i = j ^ GOST28147_mainStep(i, paramArrayOfInt[i7]);
        j = i8;
      }
    }
    int k = 0;
    label157: int n;
    if (k >= 8)
    {
      n = 0;
      label167: if (n >= 3);
    }
    for (int i1 = 7; ; i1--)
    {
      if (i1 < 0);
      while ((n == 2) && (i1 == 0))
      {
        n++;
        break label167;
        break;
        int m = i;
        i = j ^ GOST28147_mainStep(i, paramArrayOfInt[k]);
        j = m;
        k++;
        break label157;
      }
      int i2 = i;
      i = j ^ GOST28147_mainStep(i, paramArrayOfInt[i1]);
      j = i2;
    }
  }

  private int GOST28147_mainStep(int paramInt1, int paramInt2)
  {
    int i = paramInt2 + paramInt1;
    int j = (this.S[(0 + (0xF & i >> 0))] << 0) + (this.S[(16 + (0xF & i >> 4))] << 4) + (this.S[(32 + (0xF & i >> 8))] << 8) + (this.S[(48 + (0xF & i >> 12))] << 12) + (this.S[(64 + (0xF & i >> 16))] << 16) + (this.S[(80 + (0xF & i >> 20))] << 20) + (this.S[(96 + (0xF & i >> 24))] << 24) + (this.S[(112 + (0xF & i >> 28))] << 28);
    return j << 11 | j >>> 21;
  }

  private static void addSBox(String paramString, byte[] paramArrayOfByte)
  {
    sBoxes.put(Strings.toUpperCase(paramString), paramArrayOfByte);
  }

  private int bytesToint(byte[] paramArrayOfByte, int paramInt)
  {
    return (0xFF000000 & paramArrayOfByte[(paramInt + 3)] << 24) + (0xFF0000 & paramArrayOfByte[(paramInt + 2)] << 16) + (0xFF00 & paramArrayOfByte[(paramInt + 1)] << 8) + (0xFF & paramArrayOfByte[paramInt]);
  }

  private int[] generateWorkingKey(boolean paramBoolean, byte[] paramArrayOfByte)
  {
    this.forEncryption = paramBoolean;
    if (paramArrayOfByte.length != 32)
      throw new IllegalArgumentException("Key length invalid. Key needs to be 32 byte - 256 bit!!!");
    int[] arrayOfInt = new int[8];
    for (int i = 0; ; i++)
    {
      if (i == 8)
        return arrayOfInt;
      arrayOfInt[i] = bytesToint(paramArrayOfByte, i * 4);
    }
  }

  public static byte[] getSBox(String paramString)
  {
    byte[] arrayOfByte = (byte[])sBoxes.get(Strings.toUpperCase(paramString));
    if (arrayOfByte == null)
      throw new IllegalArgumentException("Unknown S-Box - possible types: \"Default\", \"E-Test\", \"E-A\", \"E-B\", \"E-C\", \"E-D\", \"D-Test\", \"D-A\".");
    return Arrays.clone(arrayOfByte);
  }

  private void intTobytes(int paramInt1, byte[] paramArrayOfByte, int paramInt2)
  {
    paramArrayOfByte[(paramInt2 + 3)] = ((byte)(paramInt1 >>> 24));
    paramArrayOfByte[(paramInt2 + 2)] = ((byte)(paramInt1 >>> 16));
    paramArrayOfByte[(paramInt2 + 1)] = ((byte)(paramInt1 >>> 8));
    paramArrayOfByte[paramInt2] = ((byte)paramInt1);
  }

  public String getAlgorithmName()
  {
    return "GOST28147";
  }

  public int getBlockSize()
  {
    return 8;
  }

  public void init(boolean paramBoolean, CipherParameters paramCipherParameters)
  {
    if ((paramCipherParameters instanceof ParametersWithSBox))
    {
      ParametersWithSBox localParametersWithSBox = (ParametersWithSBox)paramCipherParameters;
      byte[] arrayOfByte = localParametersWithSBox.getSBox();
      if (arrayOfByte.length != Sbox_Default.length)
        throw new IllegalArgumentException("invalid S-box passed to GOST28147 init");
      this.S = Arrays.clone(arrayOfByte);
      if (localParametersWithSBox.getParameters() != null)
        this.workingKey = generateWorkingKey(paramBoolean, ((KeyParameter)localParametersWithSBox.getParameters()).getKey());
    }
    do
    {
      return;
      if ((paramCipherParameters instanceof KeyParameter))
      {
        this.workingKey = generateWorkingKey(paramBoolean, ((KeyParameter)paramCipherParameters).getKey());
        return;
      }
    }
    while (paramCipherParameters == null);
    throw new IllegalArgumentException("invalid parameter passed to GOST28147 init - " + paramCipherParameters.getClass().getName());
  }

  public int processBlock(byte[] paramArrayOfByte1, int paramInt1, byte[] paramArrayOfByte2, int paramInt2)
  {
    if (this.workingKey == null)
      throw new IllegalStateException("GOST28147 engine not initialised");
    if (paramInt1 + 8 > paramArrayOfByte1.length)
      throw new DataLengthException("input buffer too short");
    if (paramInt2 + 8 > paramArrayOfByte2.length)
      throw new DataLengthException("output buffer too short");
    GOST28147Func(this.workingKey, paramArrayOfByte1, paramInt1, paramArrayOfByte2, paramInt2);
    return 8;
  }

  public void reset()
  {
  }
}